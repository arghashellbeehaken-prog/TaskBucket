{"ast":null,"code":"// src/features/auth/authSlice.js\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport api from \"../../api/apiClient\";\n\n// Async thunks\nexport const signup = createAsyncThunk(\"auth/signup\", async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.post(\"/auth/signup\", payload);\n    return res.data.user;\n  } catch (err) {\n    var _err$response, _err$response$data;\n    return rejectWithValue(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Signup failed\");\n  }\n});\nexport const login = createAsyncThunk(\"auth/login\", async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    console.log(\"Sending login payload:\", payload);\n    const res = await api.post(\"/auth/login\", payload);\n    console.log(\"Login response:\", res.data);\n    return res.data.user;\n  } catch (err) {\n    var _err$response2, _err$response2$data;\n    console.error(\"Login error:\", err);\n    const errorMsg = ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || err.message || \"Login failed\";\n    return rejectWithValue(errorMsg);\n  }\n});\nexport const logout = createAsyncThunk(\"auth/logout\", async (_, {\n  rejectWithValue\n}) => {\n  try {\n    await api.post(\"/auth/logout\");\n    return null;\n  } catch (err) {\n    var _err$response3, _err$response3$data;\n    return rejectWithValue(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || \"Logout failed\");\n  }\n});\nexport const fetchMe = createAsyncThunk(\"auth/fetchMe\", async (_, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.get(\"/auth/me\");\n    return res.data.user;\n  } catch (err) {\n    var _err$response4, _err$response4$data;\n    return rejectWithValue(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.message) || \"Fetch failed\");\n  }\n});\nexport const updateProfile = createAsyncThunk(\"auth/updateProfile\", async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    // If payload contains a file, use FormData instead of JSON\n    let data = payload;\n    let config = {};\n    if (payload instanceof FormData) {\n      data = payload;\n      config.headers = {\n        \"Content-Type\": \"multipart/form-data\"\n      };\n    }\n    const res = await api.put(\"/auth/me\", data, config);\n    return res.data.user;\n  } catch (err) {\n    var _err$response5, _err$response5$data;\n    return rejectWithValue(((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : (_err$response5$data = _err$response5.data) === null || _err$response5$data === void 0 ? void 0 : _err$response5$data.message) || \"Failed to update profile\");\n  }\n});\n\n// Initial state\nconst initialState = {\n  user: null,\n  status: \"idle\",\n  error: null,\n  initialized: false\n};\n\n// Slice\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    resetError(state) {\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(signup.pending, state => {\n      state.status = \"loading\";\n      state.error = null;\n    }).addCase(signup.fulfilled, (state, action) => {\n      state.status = \"succeeded\";\n      state.user = action.payload;\n    }).addCase(signup.rejected, (state, action) => {\n      state.status = \"failed\";\n      state.error = action.payload;\n    }).addCase(login.pending, state => {\n      state.status = \"loading\";\n      state.error = null;\n    }).addCase(login.fulfilled, (state, action) => {\n      state.status = \"succeeded\";\n      state.user = action.payload;\n    }).addCase(login.rejected, (state, action) => {\n      state.status = \"failed\";\n      state.error = action.payload;\n    }).addCase(logout.fulfilled, state => {\n      state.user = null;\n      state.status = \"idle\";\n      state.error = null;\n    }).addCase(fetchMe.pending, state => {\n      state.status = \"loading\";\n      state.initialized = true;\n    }).addCase(fetchMe.fulfilled, (state, action) => {\n      state.user = action.payload;\n      state.status = \"succeeded\";\n      state.initialized = true;\n    }).addCase(fetchMe.rejected, (state, action) => {\n      state.user = null;\n      state.status = \"failed\";\n      state.error = action.payload || \"Fetch user failed\";\n      state.initialized = true;\n    }).addCase(updateProfile.fulfilled, (state, action) => {\n      state.user = action.payload;\n    }).addCase(updateProfile.rejected, (state, action) => {\n      state.error = action.payload || \"Update profile failed\";\n    });\n  }\n});\nexport const {\n  resetError\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","signup","payload","rejectWithValue","res","post","data","user","err","_err$response","_err$response$data","response","message","login","console","log","_err$response2","_err$response2$data","error","errorMsg","logout","_","_err$response3","_err$response3$data","fetchMe","get","_err$response4","_err$response4$data","updateProfile","config","FormData","headers","put","_err$response5","_err$response5$data","initialState","status","initialized","authSlice","name","reducers","resetError","state","extraReducers","builder","addCase","pending","fulfilled","action","rejected","actions","reducer"],"sources":["/home/sbh/divyo/TaskManager/frontend/src/features/auth/authSlice.js"],"sourcesContent":["// src/features/auth/authSlice.js\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport api from \"../../api/apiClient\";\n\n// Async thunks\nexport const signup = createAsyncThunk(\"auth/signup\", async (payload, { rejectWithValue }) => {\n  try {\n    const res = await api.post(\"/auth/signup\", payload);\n    return res.data.user;\n  } catch (err) {\n    return rejectWithValue(err.response?.data?.message || \"Signup failed\");\n  }\n});\n\nexport const login = createAsyncThunk(\"auth/login\", async (payload, { rejectWithValue }) => {\n  try {\n    console.log(\"Sending login payload:\", payload);\n    const res = await api.post(\"/auth/login\", payload);\n    console.log(\"Login response:\", res.data);\n    return res.data.user;\n  } catch (err) {\n    console.error(\"Login error:\", err);\n    const errorMsg = err.response?.data?.message || err.message || \"Login failed\";\n    return rejectWithValue(errorMsg);\n  }\n});\n\nexport const logout = createAsyncThunk(\"auth/logout\", async (_, { rejectWithValue }) => {\n  try {\n    await api.post(\"/auth/logout\");\n    return null;\n  } catch (err) {\n    return rejectWithValue(err.response?.data?.message || \"Logout failed\");\n  }\n});\n\nexport const fetchMe = createAsyncThunk(\"auth/fetchMe\", async (_, { rejectWithValue }) => {\n  try {\n    const res = await api.get(\"/auth/me\");\n    return res.data.user;\n  } catch (err) {\n    return rejectWithValue(err.response?.data?.message || \"Fetch failed\");\n  }\n});\n\nexport const updateProfile = createAsyncThunk(\n  \"auth/updateProfile\",\n  async (payload, { rejectWithValue }) => {\n    try {\n      // If payload contains a file, use FormData instead of JSON\n      let data = payload;\n      let config = {};\n      \n      if (payload instanceof FormData) {\n        data = payload;\n        config.headers = {\n          \"Content-Type\": \"multipart/form-data\",\n        };\n      }\n      \n      const res = await api.put(\"/auth/me\", data, config);\n      return res.data.user;\n    } catch (err) {\n      return rejectWithValue(err.response?.data?.message || \"Failed to update profile\");\n    }\n  }\n);\n\n// Initial state\nconst initialState = {\n  user: null,\n  status: \"idle\",\n  error: null,\n  initialized: false,\n};\n\n// Slice\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    resetError(state) {\n      state.error = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(signup.pending, (state) => {\n        state.status = \"loading\";\n        state.error = null;\n      })\n      .addCase(signup.fulfilled, (state, action) => {\n        state.status = \"succeeded\";\n        state.user = action.payload;\n      })\n      .addCase(signup.rejected, (state, action) => {\n        state.status = \"failed\";\n        state.error = action.payload;\n      })\n\n      .addCase(login.pending, (state) => {\n        state.status = \"loading\";\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.status = \"succeeded\";\n        state.user = action.payload;\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.status = \"failed\";\n        state.error = action.payload;\n      })\n\n      .addCase(logout.fulfilled, (state) => {\n        state.user = null;\n        state.status = \"idle\";\n        state.error = null;\n      })\n\n      .addCase(fetchMe.pending, (state) => {\n        state.status = \"loading\";\n        state.initialized = true;\n      })\n      .addCase(fetchMe.fulfilled, (state, action) => {\n        state.user = action.payload;\n        state.status = \"succeeded\";\n        state.initialized = true;\n      })\n      .addCase(fetchMe.rejected, (state, action) => {\n        state.user = null;\n        state.status = \"failed\";\n        state.error = action.payload || \"Fetch user failed\";\n        state.initialized = true;\n      })\n      .addCase(updateProfile.fulfilled, (state, action) => {\n        state.user = action.payload;\n      })\n      .addCase(updateProfile.rejected, (state, action) => {\n        state.error = action.payload || \"Update profile failed\";\n      });\n  },\n});\n\nexport const { resetError } = authSlice.actions;\nexport default authSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}