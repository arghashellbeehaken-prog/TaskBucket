{"ast":null,"code":"// src/features/auth/authSlice.js\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport api from \"../../api/apiClient\";\n\n// Async thunks\nexport const signup = createAsyncThunk(\"auth/signup\", async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.post(\"/auth/signup\", payload);\n    return res.data.user;\n  } catch (err) {\n    var _err$response, _err$response$data;\n    return rejectWithValue(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || \"Signup failed\");\n  }\n});\nexport const login = createAsyncThunk(\"auth/login\", async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.post(\"/auth/login\", payload);\n    return res.data.user;\n  } catch (err) {\n    var _err$response2, _err$response2$data;\n    return rejectWithValue(((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || \"Login failed\");\n  }\n});\nexport const logout = createAsyncThunk(\"auth/logout\", async (_, {\n  rejectWithValue\n}) => {\n  try {\n    await api.post(\"/auth/logout\");\n    return null;\n  } catch (err) {\n    var _err$response3, _err$response3$data;\n    return rejectWithValue(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || \"Logout failed\");\n  }\n});\nexport const fetchMe = createAsyncThunk(\"auth/fetchMe\", async (_, {\n  rejectWithValue\n}) => {\n  try {\n    const res = await api.get(\"/auth/me\");\n    return res.data.user;\n  } catch (err) {\n    var _err$response4, _err$response4$data;\n    return rejectWithValue(((_err$response4 = err.response) === null || _err$response4 === void 0 ? void 0 : (_err$response4$data = _err$response4.data) === null || _err$response4$data === void 0 ? void 0 : _err$response4$data.message) || \"Fetch failed\");\n  }\n});\nexport const updateProfile = createAsyncThunk(\"auth/updateProfile\", async (payload, {\n  rejectWithValue\n}) => {\n  try {\n    // If payload contains a file, use FormData instead of JSON\n    let data = payload;\n    let config = {};\n    if (payload instanceof FormData) {\n      data = payload;\n      config.headers = {\n        \"Content-Type\": \"multipart/form-data\"\n      };\n    }\n    const res = await api.put(\"/auth/me\", data, config);\n    return res.data.user;\n  } catch (err) {\n    var _err$response5, _err$response5$data;\n    return rejectWithValue(((_err$response5 = err.response) === null || _err$response5 === void 0 ? void 0 : (_err$response5$data = _err$response5.data) === null || _err$response5$data === void 0 ? void 0 : _err$response5$data.message) || \"Failed to update profile\");\n  }\n});\n\n// Initial state\nconst initialState = {\n  user: null,\n  status: \"idle\",\n  error: null,\n  initialized: false\n};\n\n// Slice\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    resetError(state) {\n      state.error = null;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(signup.pending, state => {\n      state.status = \"loading\";\n      state.error = null;\n    }).addCase(signup.fulfilled, (state, action) => {\n      state.status = \"succeeded\";\n      state.user = action.payload;\n    }).addCase(signup.rejected, (state, action) => {\n      state.status = \"failed\";\n      state.error = action.payload;\n    }).addCase(login.pending, state => {\n      state.status = \"loading\";\n      state.error = null;\n    }).addCase(login.fulfilled, (state, action) => {\n      state.status = \"succeeded\";\n      state.user = action.payload;\n    }).addCase(login.rejected, (state, action) => {\n      state.status = \"failed\";\n      state.error = action.payload;\n    }).addCase(logout.fulfilled, state => {\n      state.user = null;\n      state.status = \"idle\";\n      state.error = null;\n    }).addCase(fetchMe.pending, state => {\n      state.status = \"loading\";\n      state.initialized = true;\n    }).addCase(fetchMe.fulfilled, (state, action) => {\n      state.user = action.payload;\n      state.status = \"succeeded\";\n      state.initialized = true;\n    }).addCase(fetchMe.rejected, (state, action) => {\n      state.user = null;\n      state.status = \"failed\";\n      state.error = action.payload || \"Fetch user failed\";\n      state.initialized = true;\n    }).addCase(updateProfile.fulfilled, (state, action) => {\n      state.user = action.payload;\n    }).addCase(updateProfile.rejected, (state, action) => {\n      state.error = action.payload || \"Update profile failed\";\n    });\n  }\n});\nexport const {\n  resetError\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","api","signup","payload","rejectWithValue","res","post","data","user","err","_err$response","_err$response$data","response","message","login","_err$response2","_err$response2$data","logout","_","_err$response3","_err$response3$data","fetchMe","get","_err$response4","_err$response4$data","updateProfile","config","FormData","headers","put","_err$response5","_err$response5$data","initialState","status","error","initialized","authSlice","name","reducers","resetError","state","extraReducers","builder","addCase","pending","fulfilled","action","rejected","actions","reducer"],"sources":["/home/sbh/divyo/TaskManager/frontend/src/features/auth/authSlice.js"],"sourcesContent":["// src/features/auth/authSlice.js\nimport { createSlice, createAsyncThunk } from \"@reduxjs/toolkit\";\nimport api from \"../../api/apiClient\";\n\n// Async thunks\nexport const signup = createAsyncThunk(\"auth/signup\", async (payload, { rejectWithValue }) => {\n  try {\n    const res = await api.post(\"/auth/signup\", payload);\n    return res.data.user;\n  } catch (err) {\n    return rejectWithValue(err.response?.data?.message || \"Signup failed\");\n  }\n});\n\nexport const login = createAsyncThunk(\"auth/login\", async (payload, { rejectWithValue }) => {\n  try {\n    const res = await api.post(\"/auth/login\", payload);\n    return res.data.user;\n  } catch (err) {\n    return rejectWithValue(err.response?.data?.message || \"Login failed\");\n  }\n});\n\nexport const logout = createAsyncThunk(\"auth/logout\", async (_, { rejectWithValue }) => {\n  try {\n    await api.post(\"/auth/logout\");\n    return null;\n  } catch (err) {\n    return rejectWithValue(err.response?.data?.message || \"Logout failed\");\n  }\n});\n\nexport const fetchMe = createAsyncThunk(\"auth/fetchMe\", async (_, { rejectWithValue }) => {\n  try {\n    const res = await api.get(\"/auth/me\");\n    return res.data.user;\n  } catch (err) {\n    return rejectWithValue(err.response?.data?.message || \"Fetch failed\");\n  }\n});\n\nexport const updateProfile = createAsyncThunk(\n  \"auth/updateProfile\",\n  async (payload, { rejectWithValue }) => {\n    try {\n      // If payload contains a file, use FormData instead of JSON\n      let data = payload;\n      let config = {};\n      \n      if (payload instanceof FormData) {\n        data = payload;\n        config.headers = {\n          \"Content-Type\": \"multipart/form-data\",\n        };\n      }\n      \n      const res = await api.put(\"/auth/me\", data, config);\n      return res.data.user;\n    } catch (err) {\n      return rejectWithValue(err.response?.data?.message || \"Failed to update profile\");\n    }\n  }\n);\n\n// Initial state\nconst initialState = {\n  user: null,\n  status: \"idle\",\n  error: null,\n  initialized: false,\n};\n\n// Slice\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState,\n  reducers: {\n    resetError(state) {\n      state.error = null;\n    },\n  },\n  extraReducers: (builder) => {\n    builder\n      .addCase(signup.pending, (state) => {\n        state.status = \"loading\";\n        state.error = null;\n      })\n      .addCase(signup.fulfilled, (state, action) => {\n        state.status = \"succeeded\";\n        state.user = action.payload;\n      })\n      .addCase(signup.rejected, (state, action) => {\n        state.status = \"failed\";\n        state.error = action.payload;\n      })\n\n      .addCase(login.pending, (state) => {\n        state.status = \"loading\";\n        state.error = null;\n      })\n      .addCase(login.fulfilled, (state, action) => {\n        state.status = \"succeeded\";\n        state.user = action.payload;\n      })\n      .addCase(login.rejected, (state, action) => {\n        state.status = \"failed\";\n        state.error = action.payload;\n      })\n\n      .addCase(logout.fulfilled, (state) => {\n        state.user = null;\n        state.status = \"idle\";\n        state.error = null;\n      })\n\n      .addCase(fetchMe.pending, (state) => {\n        state.status = \"loading\";\n        state.initialized = true;\n      })\n      .addCase(fetchMe.fulfilled, (state, action) => {\n        state.user = action.payload;\n        state.status = \"succeeded\";\n        state.initialized = true;\n      })\n      .addCase(fetchMe.rejected, (state, action) => {\n        state.user = null;\n        state.status = \"failed\";\n        state.error = action.payload || \"Fetch user failed\";\n        state.initialized = true;\n      })\n      .addCase(updateProfile.fulfilled, (state, action) => {\n        state.user = action.payload;\n      })\n      .addCase(updateProfile.rejected, (state, action) => {\n        state.error = action.payload || \"Update profile failed\";\n      });\n  },\n});\n\nexport const { resetError } = authSlice.actions;\nexport default authSlice.reducer;\n"],"mappings":"AAAA;AACA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,GAAG,MAAM,qBAAqB;;AAErC;AACA,OAAO,MAAMC,MAAM,GAAGF,gBAAgB,CAAC,aAAa,EAAE,OAAOG,OAAO,EAAE;EAAEC;AAAgB,CAAC,KAAK;EAC5F,IAAI;IACF,MAAMC,GAAG,GAAG,MAAMJ,GAAG,CAACK,IAAI,CAAC,cAAc,EAAEH,OAAO,CAAC;IACnD,OAAOE,GAAG,CAACE,IAAI,CAACC,IAAI;EACtB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAC,aAAA,EAAAC,kBAAA;IACZ,OAAOP,eAAe,CAAC,EAAAM,aAAA,GAAAD,GAAG,CAACG,QAAQ,cAAAF,aAAA,wBAAAC,kBAAA,GAAZD,aAAA,CAAcH,IAAI,cAAAI,kBAAA,uBAAlBA,kBAAA,CAAoBE,OAAO,KAAI,eAAe,CAAC;EACxE;AACF,CAAC,CAAC;AAEF,OAAO,MAAMC,KAAK,GAAGd,gBAAgB,CAAC,YAAY,EAAE,OAAOG,OAAO,EAAE;EAAEC;AAAgB,CAAC,KAAK;EAC1F,IAAI;IACF,MAAMC,GAAG,GAAG,MAAMJ,GAAG,CAACK,IAAI,CAAC,aAAa,EAAEH,OAAO,CAAC;IAClD,OAAOE,GAAG,CAACE,IAAI,CAACC,IAAI;EACtB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAM,cAAA,EAAAC,mBAAA;IACZ,OAAOZ,eAAe,CAAC,EAAAW,cAAA,GAAAN,GAAG,CAACG,QAAQ,cAAAG,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcR,IAAI,cAAAS,mBAAA,uBAAlBA,mBAAA,CAAoBH,OAAO,KAAI,cAAc,CAAC;EACvE;AACF,CAAC,CAAC;AAEF,OAAO,MAAMI,MAAM,GAAGjB,gBAAgB,CAAC,aAAa,EAAE,OAAOkB,CAAC,EAAE;EAAEd;AAAgB,CAAC,KAAK;EACtF,IAAI;IACF,MAAMH,GAAG,CAACK,IAAI,CAAC,cAAc,CAAC;IAC9B,OAAO,IAAI;EACb,CAAC,CAAC,OAAOG,GAAG,EAAE;IAAA,IAAAU,cAAA,EAAAC,mBAAA;IACZ,OAAOhB,eAAe,CAAC,EAAAe,cAAA,GAAAV,GAAG,CAACG,QAAQ,cAAAO,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcZ,IAAI,cAAAa,mBAAA,uBAAlBA,mBAAA,CAAoBP,OAAO,KAAI,eAAe,CAAC;EACxE;AACF,CAAC,CAAC;AAEF,OAAO,MAAMQ,OAAO,GAAGrB,gBAAgB,CAAC,cAAc,EAAE,OAAOkB,CAAC,EAAE;EAAEd;AAAgB,CAAC,KAAK;EACxF,IAAI;IACF,MAAMC,GAAG,GAAG,MAAMJ,GAAG,CAACqB,GAAG,CAAC,UAAU,CAAC;IACrC,OAAOjB,GAAG,CAACE,IAAI,CAACC,IAAI;EACtB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAc,cAAA,EAAAC,mBAAA;IACZ,OAAOpB,eAAe,CAAC,EAAAmB,cAAA,GAAAd,GAAG,CAACG,QAAQ,cAAAW,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAchB,IAAI,cAAAiB,mBAAA,uBAAlBA,mBAAA,CAAoBX,OAAO,KAAI,cAAc,CAAC;EACvE;AACF,CAAC,CAAC;AAEF,OAAO,MAAMY,aAAa,GAAGzB,gBAAgB,CAC3C,oBAAoB,EACpB,OAAOG,OAAO,EAAE;EAAEC;AAAgB,CAAC,KAAK;EACtC,IAAI;IACF;IACA,IAAIG,IAAI,GAAGJ,OAAO;IAClB,IAAIuB,MAAM,GAAG,CAAC,CAAC;IAEf,IAAIvB,OAAO,YAAYwB,QAAQ,EAAE;MAC/BpB,IAAI,GAAGJ,OAAO;MACduB,MAAM,CAACE,OAAO,GAAG;QACf,cAAc,EAAE;MAClB,CAAC;IACH;IAEA,MAAMvB,GAAG,GAAG,MAAMJ,GAAG,CAAC4B,GAAG,CAAC,UAAU,EAAEtB,IAAI,EAAEmB,MAAM,CAAC;IACnD,OAAOrB,GAAG,CAACE,IAAI,CAACC,IAAI;EACtB,CAAC,CAAC,OAAOC,GAAG,EAAE;IAAA,IAAAqB,cAAA,EAAAC,mBAAA;IACZ,OAAO3B,eAAe,CAAC,EAAA0B,cAAA,GAAArB,GAAG,CAACG,QAAQ,cAAAkB,cAAA,wBAAAC,mBAAA,GAAZD,cAAA,CAAcvB,IAAI,cAAAwB,mBAAA,uBAAlBA,mBAAA,CAAoBlB,OAAO,KAAI,0BAA0B,CAAC;EACnF;AACF,CACF,CAAC;;AAED;AACA,MAAMmB,YAAY,GAAG;EACnBxB,IAAI,EAAE,IAAI;EACVyB,MAAM,EAAE,MAAM;EACdC,KAAK,EAAE,IAAI;EACXC,WAAW,EAAE;AACf,CAAC;;AAED;AACA,MAAMC,SAAS,GAAGrC,WAAW,CAAC;EAC5BsC,IAAI,EAAE,MAAM;EACZL,YAAY;EACZM,QAAQ,EAAE;IACRC,UAAUA,CAACC,KAAK,EAAE;MAChBA,KAAK,CAACN,KAAK,GAAG,IAAI;IACpB;EACF,CAAC;EACDO,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAACzC,MAAM,CAAC0C,OAAO,EAAGJ,KAAK,IAAK;MAClCA,KAAK,CAACP,MAAM,GAAG,SAAS;MACxBO,KAAK,CAACN,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDS,OAAO,CAACzC,MAAM,CAAC2C,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MAC5CN,KAAK,CAACP,MAAM,GAAG,WAAW;MAC1BO,KAAK,CAAChC,IAAI,GAAGsC,MAAM,CAAC3C,OAAO;IAC7B,CAAC,CAAC,CACDwC,OAAO,CAACzC,MAAM,CAAC6C,QAAQ,EAAE,CAACP,KAAK,EAAEM,MAAM,KAAK;MAC3CN,KAAK,CAACP,MAAM,GAAG,QAAQ;MACvBO,KAAK,CAACN,KAAK,GAAGY,MAAM,CAAC3C,OAAO;IAC9B,CAAC,CAAC,CAEDwC,OAAO,CAAC7B,KAAK,CAAC8B,OAAO,EAAGJ,KAAK,IAAK;MACjCA,KAAK,CAACP,MAAM,GAAG,SAAS;MACxBO,KAAK,CAACN,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CACDS,OAAO,CAAC7B,KAAK,CAAC+B,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MAC3CN,KAAK,CAACP,MAAM,GAAG,WAAW;MAC1BO,KAAK,CAAChC,IAAI,GAAGsC,MAAM,CAAC3C,OAAO;IAC7B,CAAC,CAAC,CACDwC,OAAO,CAAC7B,KAAK,CAACiC,QAAQ,EAAE,CAACP,KAAK,EAAEM,MAAM,KAAK;MAC1CN,KAAK,CAACP,MAAM,GAAG,QAAQ;MACvBO,KAAK,CAACN,KAAK,GAAGY,MAAM,CAAC3C,OAAO;IAC9B,CAAC,CAAC,CAEDwC,OAAO,CAAC1B,MAAM,CAAC4B,SAAS,EAAGL,KAAK,IAAK;MACpCA,KAAK,CAAChC,IAAI,GAAG,IAAI;MACjBgC,KAAK,CAACP,MAAM,GAAG,MAAM;MACrBO,KAAK,CAACN,KAAK,GAAG,IAAI;IACpB,CAAC,CAAC,CAEDS,OAAO,CAACtB,OAAO,CAACuB,OAAO,EAAGJ,KAAK,IAAK;MACnCA,KAAK,CAACP,MAAM,GAAG,SAAS;MACxBO,KAAK,CAACL,WAAW,GAAG,IAAI;IAC1B,CAAC,CAAC,CACDQ,OAAO,CAACtB,OAAO,CAACwB,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MAC7CN,KAAK,CAAChC,IAAI,GAAGsC,MAAM,CAAC3C,OAAO;MAC3BqC,KAAK,CAACP,MAAM,GAAG,WAAW;MAC1BO,KAAK,CAACL,WAAW,GAAG,IAAI;IAC1B,CAAC,CAAC,CACDQ,OAAO,CAACtB,OAAO,CAAC0B,QAAQ,EAAE,CAACP,KAAK,EAAEM,MAAM,KAAK;MAC5CN,KAAK,CAAChC,IAAI,GAAG,IAAI;MACjBgC,KAAK,CAACP,MAAM,GAAG,QAAQ;MACvBO,KAAK,CAACN,KAAK,GAAGY,MAAM,CAAC3C,OAAO,IAAI,mBAAmB;MACnDqC,KAAK,CAACL,WAAW,GAAG,IAAI;IAC1B,CAAC,CAAC,CACDQ,OAAO,CAAClB,aAAa,CAACoB,SAAS,EAAE,CAACL,KAAK,EAAEM,MAAM,KAAK;MACnDN,KAAK,CAAChC,IAAI,GAAGsC,MAAM,CAAC3C,OAAO;IAC7B,CAAC,CAAC,CACDwC,OAAO,CAAClB,aAAa,CAACsB,QAAQ,EAAE,CAACP,KAAK,EAAEM,MAAM,KAAK;MAClDN,KAAK,CAACN,KAAK,GAAGY,MAAM,CAAC3C,OAAO,IAAI,uBAAuB;IACzD,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEoC;AAAW,CAAC,GAAGH,SAAS,CAACY,OAAO;AAC/C,eAAeZ,SAAS,CAACa,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}